import pandas
from datautil.common import path_to_save_base

def load_dumped_csv(savefilename, filename):
    return pandas.read_csv(path_to_save_base(savefilename) + r"/import_export/csv/" + filename + ".csv")

def load_players(savefilename):
    '''
    player_id	team_id	league_id	position	role	first_name	last_name	nick_name	age	date_of_birth	city_of_birth_id	nation_id	second_nation_id	weight	height	retired	free_agent	last_league_id	last_team_id	organization_id	last_organization_id	language_ids0	language_ids1	uniform_number	experience	person_type	bats	throws	personality_greed	personality_loyalty	personality_play_for_winner	personality_work_ethic	personality_intelligence	personality_leader	historical_id	historical_team_id	best_contract_offer_id	injury_is_injured	injury_dtd_injury	injury_career_ending	injury_dl_left	injury_dl_playoff_round	injury_left	dtd_injury_effect	dtd_injury_effect_hit	dtd_injury_effect_throw	dtd_injury_effect_run	injury_id	injury_id2	injury_dtd_injury2	injury_left2	dtd_injury_effect2	dtd_injury_effect_hit2	dtd_injury_effect_throw2	dtd_injury_effect_run2	prone_overall	prone_leg	prone_back	prone_arm	fatigue_pitches0	fatigue_pitches1	fatigue_pitches2	fatigue_pitches3	fatigue_pitches4	fatigue_pitches5	fatigue_points	fatigue_played_today	running_ratings_speed	running_ratings_stealing	running_ratings_baserunning	college	acquired	acquired_date	draft_year	draft_round	draft_supplemental	draft_pick	draft_overall_pick	draft_eligible	hsc_status	redshirt	picked_in_draft	school	commit_school	hidden	draft_league_id	draft_team_id	turned_coach	hall_of_fame	rust	inducted	strategy_override_team	strategy_stealing	strategy_running	strategy_bunt_for_hit	strategy_sac_bunt	strategy_hit_run	strategy_hook_start	strategy_hook_relief	strategy_pitch_count	strategy_pitch_around	strategy_never_pinch_hit	strategy_defensive_sub	strategy_dtd_sit_min	strategy_dtd_allow_ph	local_pop	national_pop	draft_protected	morale	morale_player_performance	morale_team_performance	morale_team_transactions	expectation	morale_player_role	on_loan	loan_league_id	loan_team_id
    '''
    p = load_dumped_csv(savefilename, 'players')    
    '''
    player_id	team_id	league_id	position	role	batting_ratings_overall_contact	batting_ratings_overall_gap	batting_ratings_overall_eye	batting_ratings_overall_strikeouts	batting_ratings_overall_hp	batting_ratings_overall_power	batting_ratings_overall_babip	batting_ratings_vsr_contact	batting_ratings_vsr_gap	batting_ratings_vsr_eye	batting_ratings_vsr_strikeouts	batting_ratings_vsr_hp	batting_ratings_vsr_power	batting_ratings_vsr_babip	batting_ratings_vsl_contact	batting_ratings_vsl_gap	batting_ratings_vsl_eye	batting_ratings_vsl_strikeouts	batting_ratings_vsl_hp	batting_ratings_vsl_power	batting_ratings_vsl_babip	batting_ratings_talent_contact	batting_ratings_talent_gap	batting_ratings_talent_eye	batting_ratings_talent_strikeouts	batting_ratings_talent_hp	batting_ratings_talent_power	batting_ratings_talent_babip	batting_ratings_misc_bunt	batting_ratings_misc_bunt_for_hit	batting_ratings_misc_gb_hitter_type	batting_ratings_misc_fb_hitter_type
    '''
    bat = load_dumped_csv(savefilename, 'players_batting')
    '''
    player_id	team_id	league_id	position	role	pitching_ratings_overall_stuff	pitching_ratings_overall_control	pitching_ratings_overall_movement	pitching_ratings_overall_balk	pitching_ratings_overall_hp	pitching_ratings_overall_wild_pitch	pitching_ratings_vsr_stuff	pitching_ratings_vsr_control	pitching_ratings_vsr_movement	pitching_ratings_vsr_balk	pitching_ratings_vsr_hp	pitching_ratings_vsr_wild_pitch	pitching_ratings_vsl_stuff	pitching_ratings_vsl_control	pitching_ratings_vsl_movement	pitching_ratings_vsl_balk	pitching_ratings_vsl_hp	pitching_ratings_vsl_wild_pitch	pitching_ratings_talent_stuff	pitching_ratings_talent_control	pitching_ratings_talent_movement	pitching_ratings_talent_balk	pitching_ratings_talent_hp	pitching_ratings_talent_wild_pitch	pitching_ratings_pitches_fastball	pitching_ratings_pitches_slider	pitching_ratings_pitches_curveball	pitching_ratings_pitches_screwball	pitching_ratings_pitches_forkball	pitching_ratings_pitches_changeup	pitching_ratings_pitches_sinker	pitching_ratings_pitches_splitter	pitching_ratings_pitches_knuckleball	pitching_ratings_pitches_cutter	pitching_ratings_pitches_circlechange	pitching_ratings_pitches_knucklecurve	pitching_ratings_pitches_talent_fastball	pitching_ratings_pitches_talent_slider	pitching_ratings_pitches_talent_curveball	pitching_ratings_pitches_talent_screwball	pitching_ratings_pitches_talent_forkball	pitching_ratings_pitches_talent_changeup	pitching_ratings_pitches_talent_sinker	pitching_ratings_pitches_talent_splitter	pitching_ratings_pitches_talent_knuckleball	pitching_ratings_pitches_talent_cutter	pitching_ratings_pitches_talent_circlechange	pitching_ratings_pitches_talent_knucklecurve	pitching_ratings_misc_velocity	pitching_ratings_misc_arm_slot	pitching_ratings_misc_stamina	pitching_ratings_misc_ground_fly	pitching_ratings_misc_hold	pitching_ratings_babip
    '''
    pit = load_dumped_csv(savefilename, 'players_pitching')

    return p.merge(bat, on='player_id').merge(pit, on='player_id')

def load_player_rating_map(savefilename):
    players_df = load_players(savefilename)
    rating_map = players_df.set_index('player_id').T.to_dict()

    return rating_map